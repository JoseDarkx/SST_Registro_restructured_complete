<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Dashboard Administrador</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

  <!-- CSS personalizado -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">

  <!-- Chart.js para los gráficos -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div class="d-flex">
    
    <!-- Sidebar -->
    <nav class="sidebar text-white p-3" style="width: 250px; background-color: #5d79d4; min-height: 100vh;">
      <h5 class="mb-4">SST-AnalyTIC</h5>
      <ul class="nav flex-column">
        <!-- Menú lateral con secciones -->
        <li class="nav-item">
          <a class="nav-link text-white" href="{{ url_for('dashboard') }}">
            Dashboard
          </a>
        </li>
        <li><a href="/dashboard" class="menu-link">Inicio</a></li>

        <li class="section-title">GESTIÓN PRINCIPAL</li>
        <li><a href="/capacitaciones" class="menu-link">Capacitaciones</a></li>
        <li><a href="/evaluaciones_medicas" class="menu-link">Evaluaciones Médicas</a></li>
        <li><a href="/matriz_iper" class="menu-link">Matriz IPER</a></li>
        <li><a href="//control_epp" class="menu-link">Gestión EPP</a></li>
        <li><a href="/normas_legales" class="menu-link">Normas Legales</a></li>
        <li><a href="/firma_digital" class="menu-link">Firma Digital</a></li>
        <li><a href="/solicitudes_contrasena" class="menu-link">Solicitudes Contraseña</a></li>

        <li class="section-title">ADMINISTRACIÓN</li>
        <li><a href="/empresas" class="menu-link">Empresas</a></li>
        <li><a href="/usuarios" class="menu-link">Usuarios</a></li>
        <li><a href="/visualizacion_global" class="menu-link">Visualización Global</a></li>
        <li><a href="/formatos_globales" class="menu-link">Formatos Globales</a></li>
        <li><a href="/documentacion" class="menu-link">Documentación</a></li>

        <li class="section-title">GESTIÓN DE PERSONAL</li>
        <li><a href="/visualizacion_filtros" class="menu-link">Visualización y Filtros</a></li>
        <li><a href="/planes_accion" class="menu-link">Planes de Acción</a></li>
        <li><a href="/incidentes_accidentes" class="menu-link">Incidentes y Accidentes</a></li>
        <li><a href="/historial_cambios" class="menu-link">Historial de Cambios</a></li>
      </ul>
    </nav>

    <!-- Contenido principal -->
    <div class="content flex-grow-1">

      <!-- Barra superior -->
      <header class="bg-light d-flex justify-content-between align-items-center px-4 py-2 border-bottom">
        <div><strong>Solicitudes Contraseña</strong></div>
        <div class="text-end">
          <div>{{ usuario_actual.nombre_completo }}</div>
          <div class="text-muted small">{{ usuario_actual.rol }}</div>
          <a href="{{ url_for('cerrar_sesion') }}">
            <img src="{{ url_for('static', filename='img/logout-icon.png') }}" alt="Salir" width="20">
          </a>
        </div>
      </header>
        <div class="container mt-5">

        <!-- Encabezado de la página -->
        <div class="d-flex justify-content-between mb-4">
            <h3>Solicitudes de Contraseña</h3>
            <div>
                <strong>{{ usuario_actual.nombre_completo }}</strong>
                <small class="text-muted">({{ usuario_actual.rol }})</small>
            </div>
        </div>

        <!-- Tabla de solicitudes pendientes -->
        <table class="table table-bordered">
            <thead class="table-secondary">
                <tr>
                    <th>ID</th>
                    <th>Empresa</th>
                    <th>Correo</th>
                    <th>Fecha de Solicitud</th>
                    <th>Asignar Contraseña</th>
                </tr>
            </thead>
            <tbody>
                {% for solicitud in solicitudes %}
                <tr>
                    <td>{{ solicitud.id }}</td>
                    <td>{{ solicitud.nit_empresa }}</td>
                    <td>{{ solicitud.correo }}</td>
                    <td>{{ solicitud.fecha_solicitud }}</td>
                    <td>
                        <!-- Formulario para asignar contraseña -->
                        <form method="POST">
                            <input type="hidden" name="solicitud_id" value="{{ solicitud.id }}">
                            <div class="input-group">
                                <input type="text" name="nueva_contrasena" class="form-control" placeholder="Nueva contraseña" required>
                                <button class="btn btn-success" type="submit">Asignar</button>
                            </div>
                        </form>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="5" class="text-center text-muted">No hay solicitudes pendientes</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>


</body>
</html>

