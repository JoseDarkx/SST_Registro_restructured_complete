<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Inventario de EPP</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="..//static/css/ver_inventario.css">
</head>
<body>
</div>
    <div class="sidebar">
    <h2>SST-AnalyTIC</h2>
    <ul>
        <li><a href="/dashboard" class="menu-link">Inicio</a></li>

        <li class="section-title">GESTIÓN PRINCIPAL</li>
        <li><a href="/capacitaciones" class="menu-link">Capacitaciones</a></li>
        <li><a href="/evaluaciones_medicas" class="menu-link">Evaluaciones Médicas</a></li>
        <li><a href="/matriz_iper" class="menu-link">Matriz IPER</a></li>
        <li><a href="//control_epp" class="menu-link">Gestión EPP</a></li>
        <li><a href="/normas_legales" class="menu-link">Normas Legales</a></li>
        <li><a href="/firma_digital" class="menu-link">Firma Digital</a></li>
        <li><a href="/solicitudes_contrasena" class="menu-link">Solicitudes Contraseña</a></li>

        <li class="section-title">ADMINISTRACIÓN</li>
        <li><a href="/empresas" class="menu-link">Empresas</a></li>
        <li><a href="/usuarios" class="menu-link">Usuarios</a></li>
        <li><a href="/visualizacion_global" class="menu-link">Visualización Global</a></li>
        <li><a href="/formatos_globales" class="menu-link">Formatos Globales</a></li>
        <li><a href="/documentacion" class="menu-link">Documentación</a></li>

        <li class="section-title">GESTIÓN DE PERSONAL</li>
        <li><a href="/visualizacion_filtros" class="menu-link">Visualización y Filtros</a></li>
        <li><a href="/planes_accion" class="menu-link">Planes de Acción</a></li>
        <li><a href="/incidentes_accidentes" class="menu-link">Incidentes y Accidentes</a></li>
        <li><a href="/historial_cambios" class="menu-link">Historial de Cambios</a></li>
    </ul>
</div>
    <!-- Contenido principal -->
    <div class="content flex-grow-1">

<div class="container py-4">
    <h3 class="mb-4 titulo-inventario">Inventario de Elementos de Protección Personal (EPP)</h3>

    <!-- Indicadores Dashboard -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card text-white bg-primary shadow">
                <div class="card-body">
                    <h6 class="card-title">Total EPP</h6>
                    <h4 class="card-text">{{ total_epp }}</h4>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-white bg-warning shadow">
                <div class="card-body">
                    <h6 class="card-title">Stock Bajo (&le; 120 días)</h6>
                    <h4 class="card-text">{{ stock_bajo }}</h4>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-white bg-danger shadow">
                <div class="card-body">
                    <h6 class="card-title">Agotados (Vencidos)</h6>
                    <h4 class="card-text">{{ agotados }}</h4>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-white bg-success shadow">
                <div class="card-body">
                    <h6 class="card-title">Entregados este mes</h6>
                    <h4 class="card-text">{{ entregados_mes }}</h4>
                </div>
            </div>
        </div>
    </div>

    <!-- Botones -->
    <div class="d-flex justify-content-between mb-3">
        <a href="{{ url_for('control_epp') }}" class="btn btn-secondary">← Volver</a>
        <a href="{{ url_for('agregar_epp') }}" class="btn btn-success">Registrar nuevo EPP</a>
    </div>

    <!-- Tabla de inventario -->
    <div class="table-responsive">
        <table class="table table-bordered table-striped align-middle">
            <thead class="table-primary">
                <tr>
                    <th>ID</th>
                    <th>Nombre</th>
                    <th>Tipo de Protección</th>
                    <th>Normativa</th>
                    <th>Proveedor</th>
                    <th>Vida útil (días)</th>
                    <th>Fecha de Vencimiento</th>
                    <th>Stock</th>
                    <th>Acción</th>
                </tr>
            </thead>
            <tbody>
                {% for epp in epps %}
                    <tr>
                        <td>{{ epp.id }}</td>
                        <td>{{ epp.nombre }}</td>
                        <td>{{ epp.tipo_proteccion }}</td>
                        <td>{{ epp.normativa_cumplida }}</td>
                        <td>{{ epp.proveedor }}</td>
                        <td>{{ epp.vida_util_dias }}</td>
                        <td>{{ epp.fecha_vencimiento }}</td>
                        <td>{{ epp.stock }}</td>

                        <td>
                            <a href="{{ url_for('editar_epp', epp_id=epp.id) }}" class="btn btn-sm btn-warning">Editar</a>
                            <a href="{{ url_for('eliminar_epp', epp_id=epp.id) }}" class="btn btn-sm btn-danger" onclick="return confirm('¿Estás seguro de eliminar este EPP?');">Eliminar</a>
                        </td>

                    </tr>
                {% else %}
                    <tr>
                        <td colspan="8" class="text-center text-muted">No hay EPP registrados.</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

</body>
</html>
